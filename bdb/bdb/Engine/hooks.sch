;*=====================================================================*/
;*    serrano/prgm/project/bdk/kbdb/kbdb/Engine/hooks.sch              */
;*    -------------------------------------------------------------    */
;*    Author      :  Manuel Serrano                                    */
;*    Creation    :  Mon Aug  2 16:26:25 1999                          */
;*    Last change :  Mon Aug 23 11:26:18 1999 (serrano)                */
;*    -------------------------------------------------------------    */
;*    The macro that runs the hooks.                                   */
;*=====================================================================*/

;*---------------------------------------------------------------------*/
;*    run-hooks ...                                                    */
;*---------------------------------------------------------------------*/
(define-macro (run-hooks hooks . args)
   (let ((old (gensym)))
      `(let ((,old ,hooks))
	  (set! ,hooks '())
	  (for-each (lambda (f) (f ,@args)) ,old)
	  (set! ,hooks ,old))))

