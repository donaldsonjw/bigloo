;*=====================================================================*/
;*    serrano/prgm/project/bigloo/cigloo/Parser/tools.scm              */
;*    -------------------------------------------------------------    */
;*    Author      :  Manuel Serrano                                    */
;*    Creation    :  Wed Jul 12 16:35:55 1995                          */
;*    Last change :  Thu Sep 24 08:15:43 1998 (serrano)                */
;*    -------------------------------------------------------------    */
;*    Some parser tools                                                */
;*=====================================================================*/

;*---------------------------------------------------------------------*/
;*    The module                                                       */
;*---------------------------------------------------------------------*/
(module parser_tools
   (include "Parser/coord.sch")
   (export  (the-coord ::input-port)
	    (get-coord token)))

;*---------------------------------------------------------------------*/
;*    the-coord ...                                                    */
;*---------------------------------------------------------------------*/
(define (the-coord input-port)
   (coord (input-port-name input-port) (input-port-position input-port)))

;*---------------------------------------------------------------------*/
;*    get-coord ...                                                    */
;*---------------------------------------------------------------------*/
(define (get-coord token)
   (match-case token
      ((?coord . ?-)
       coord)
      (else
       (error "get-coord" "Illegal token" token))))
