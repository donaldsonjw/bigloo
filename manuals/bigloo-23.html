<!-- 95% W3C COMPLIANT, 95% CSS FREE, RAW HTML -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1">
<title>Bigloo</title>
 <style type="text/css">
  <!--
  pre { font-family: monospace }
  tt { font-family: monospace }
  code { font-family: monospace }
  p.flushright { text-align: right }
  p.flushleft { text-align: left }
  span.sc { font-variant: small-caps }
  span.sf { font-family: sans-serif }
  span.skribetitle { font-family: sans-serif; font-weight: bolder; font-size: x-large; }
  span.refscreen { }
  span.refprint { display: none; }
  -->
 </style>
</head>

<body class="chapter" bgcolor="#ffffff">
<table width="100%" class="skribetitle" cellspacing="0" cellpadding="0"><tbody>
<tr><td align="center" bgcolor="#8381de"><div class="skribetitle"><strong><big><big><big>22. Bigloo<br/>A practical Scheme compiler<br/>User manual for version 4.2a<br/>May 2015 -- CSV</big></big></big></strong></div><center>
</center>
</td></tr></tbody></table>
<table cellpadding="3" cellspacing="0" width="100%" class="skribe-margins"><tr>
<td align="left" valign="top" class="skribe-left-margin" width="20%" bgcolor="#dedeff"><div class="skribe-left-margin">
<br/><center id='center34503'
><table width="97%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse;" frame="box" rules="none"><tbody>
<tr bgcolor="#8381de"><th id="tc34493" align="center" colspan="1"><font color="#ffffff"><strong id='bold34491'
>main page</strong></font></th></tr>
<tr bgcolor="#ffffff"><td id="tc34500" align="center" colspan="1"><table width="100%" border="0" style="border-collapse: collapse;" frame="void" rules="none"><tbody>
<tr><td id="tc34496" align="left" valign="top" colspan="1"><strong id='bold34495'
>top:</strong></td><td id="tc34497" align="right" valign="top" colspan="1"><a href="bigloo.html#Bigloo-A-practical-Scheme-compiler-User-manual-for-version-4.2a-May-2015" class="inbound">Bigloo<br/>A practical Scheme compiler<br/>User manual for version 4.2a<br/>May 2015</a></td></tr>
</tbody></table>
</td></tr>
</tbody></table>
</center>
<br/><br/><center id='center34513'
><table width="97%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse;" frame="box" rules="none"><tbody>
<tr bgcolor="#8381de"><th id="tc34507" align="center" colspan="1"><font color="#ffffff"><strong id='bold34505'
>CSV</strong></font></th></tr>
<tr bgcolor="#ffffff"><td id="tc34510" align="center" colspan="1"><table cellspacing="1" cellpadding="1" width="100%" class="toc">
<tbody>
 <tr><td valign="top" align="left">22.1</td><td colspan="4" width="100%"><a href="bigloo-23.html#Overview">Overview</a></td></tr>
 <tr><td valign="top" align="left">22.2</td><td colspan="4" width="100%"><a href="bigloo-23.html#API-Reference">API Reference</a></td></tr>
</tbody>
</table>
</td></tr>
</tbody></table>
</center>
<br/><br/><center id='center34523'
><table width="97%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse;" frame="box" rules="none"><tbody>
<tr bgcolor="#8381de"><th id="tc34517" align="center" colspan="1"><font color="#ffffff"><strong id='bold34515'
>Chapters</strong></font></th></tr>
<tr bgcolor="#ffffff"><td id="tc34520" align="center" colspan="1"><table cellspacing="1" cellpadding="1" width="100%" class="toc">
<tbody>
 <tr><td valign="top" align="left"></td><td colspan="4" width="100%"><a href="bigloo-1.html#Acknowledgements">Acknowledgements</a></td></tr>
 <tr><td valign="top" align="left">1</td><td colspan="4" width="100%"><a href="bigloo-2.html#Table-of-contents">Table of contents</a></td></tr>
 <tr><td valign="top" align="left">2</td><td colspan="4" width="100%"><a href="bigloo-3.html#Overview-of-Bigloo">Overview of Bigloo</a></td></tr>
 <tr><td valign="top" align="left">3</td><td colspan="4" width="100%"><a href="bigloo-4.html#Modules">Modules</a></td></tr>
 <tr><td valign="top" align="left">4</td><td colspan="4" width="100%"><a href="bigloo-5.html#Core-Language">Core Language</a></td></tr>
 <tr><td valign="top" align="left">5</td><td colspan="4" width="100%"><a href="bigloo-6.html#DSSSL-support">DSSSL support</a></td></tr>
 <tr><td valign="top" align="left">6</td><td colspan="4" width="100%"><a href="bigloo-7.html#Standard-Library">Standard Library</a></td></tr>
 <tr><td valign="top" align="left">7</td><td colspan="4" width="100%"><a href="bigloo-8.html#Pattern-Matching">Pattern Matching</a></td></tr>
 <tr><td valign="top" align="left">8</td><td colspan="4" width="100%"><a href="bigloo-9.html#Fast-search">Fast search</a></td></tr>
 <tr><td valign="top" align="left">9</td><td colspan="4" width="100%"><a href="bigloo-10.html#Structures-and-Records">Structures and Records</a></td></tr>
 <tr><td valign="top" align="left">10</td><td colspan="4" width="100%"><a href="bigloo-11.html#Object-System">Object System</a></td></tr>
 <tr><td valign="top" align="left">11</td><td colspan="4" width="100%"><a href="bigloo-12.html#Regular-parsing">Regular parsing</a></td></tr>
 <tr><td valign="top" align="left">12</td><td colspan="4" width="100%"><a href="bigloo-13.html#Lalr(1)-parsing">Lalr(1) parsing</a></td></tr>
 <tr><td valign="top" align="left">13</td><td colspan="4" width="100%"><a href="bigloo-14.html#Posix-Regular-Expressions">Posix Regular Expressions</a></td></tr>
 <tr><td valign="top" align="left">14</td><td colspan="4" width="100%"><a href="bigloo-15.html#Command-Line-Parsing">Command Line Parsing</a></td></tr>
 <tr><td valign="top" align="left">15</td><td colspan="4" width="100%"><a href="bigloo-16.html#Cryptography">Cryptography</a></td></tr>
 <tr><td valign="top" align="left">16</td><td colspan="4" width="100%"><a href="bigloo-17.html#Errors-Assertions-and-Traces">Errors, Assertions, and Traces</a></td></tr>
 <tr><td valign="top" align="left">17</td><td colspan="4" width="100%"><a href="bigloo-18.html#Threads">Threads</a></td></tr>
 <tr><td valign="top" align="left">18</td><td colspan="4" width="100%"><a href="bigloo-19.html#Database">Database</a></td></tr>
 <tr><td valign="top" align="left">19</td><td colspan="4" width="100%"><a href="bigloo-20.html#Multimedia">Multimedia</a></td></tr>
 <tr><td valign="top" align="left">20</td><td colspan="4" width="100%"><a href="bigloo-21.html#Mail">Mail</a></td></tr>
 <tr><td valign="top" align="left">21</td><td colspan="4" width="100%"><a href="bigloo-22.html#Text">Text</a></td></tr>
 <tr><td valign="top" align="left">22</td><td colspan="4" width="100%"><a href="bigloo-23.html#CSV">CSV</a></td></tr>
 <tr><td valign="top" align="left">23</td><td colspan="4" width="100%"><a href="bigloo-24.html#Eval-and-code-interpretation">Eval and code interpretation</a></td></tr>
 <tr><td valign="top" align="left">24</td><td colspan="4" width="100%"><a href="bigloo-25.html#Macro-expansion">Macro expansion</a></td></tr>
 <tr><td valign="top" align="left">25</td><td colspan="4" width="100%"><a href="bigloo-26.html#Parameters">Parameters</a></td></tr>
 <tr><td valign="top" align="left">26</td><td colspan="4" width="100%"><a href="bigloo-27.html#Explicit-typing">Explicit typing</a></td></tr>
 <tr><td valign="top" align="left">27</td><td colspan="4" width="100%"><a href="bigloo-28.html#The-C-interface">The C interface</a></td></tr>
 <tr><td valign="top" align="left">28</td><td colspan="4" width="100%"><a href="bigloo-29.html#The-Java-interface">The Java interface</a></td></tr>
 <tr><td valign="top" align="left">29</td><td colspan="4" width="100%"><a href="bigloo-30.html#Bigloo-Libraries">Bigloo Libraries</a></td></tr>
 <tr><td valign="top" align="left">30</td><td colspan="4" width="100%"><a href="bigloo-31.html#Extending-the-Runtime-System">Extending the Runtime System</a></td></tr>
 <tr><td valign="top" align="left">31</td><td colspan="4" width="100%"><a href="bigloo-32.html#SRFIs">SRFIs</a></td></tr>
 <tr><td valign="top" align="left">32</td><td colspan="4" width="100%"><a href="bigloo-33.html#Compiler-description">Compiler description</a></td></tr>
 <tr><td valign="top" align="left">33</td><td colspan="4" width="100%"><a href="bigloo-34.html#Cross-Compilation">Cross Compilation</a></td></tr>
 <tr><td valign="top" align="left">34</td><td colspan="4" width="100%"><a href="bigloo-35.html#User-Extensions">User Extensions</a></td></tr>
 <tr><td valign="top" align="left">35</td><td colspan="4" width="100%"><a href="bigloo-36.html#Bigloo-Development-Environment">Bigloo Development Environment</a></td></tr>
 <tr><td valign="top" align="left">36</td><td colspan="4" width="100%"><a href="bigloo-37.html#Global-Index">Global Index</a></td></tr>
 <tr><td valign="top" align="left">37</td><td colspan="4" width="100%"><a href="bigloo-38.html#Library-Index">Library Index</a></td></tr>
 <tr><td valign="top" align="left"></td><td colspan="4" width="100%"><a href="bigloo-39.html#Bibliography">Bibliography</a></td></tr>
</tbody>
</table>
</td></tr>
</tbody></table>
</center>
</div></td>
<td align="left" valign="top" class="skribe-body"><div class="skribe-body">
<a name="CSV" class="mark"></a><a name="g25654" class="mark"></a>
This chapter describes the Bigloo API for processing CSV spreadsheets.
This chapter has been written by Joseph Donaldson, as the implementation
of the CSV library.<br/><br/>
<!-- Overview -->
<a name="Overview"></a>
<div class="section-atitle"><table width="100%"><tr><td bgcolor="#dedeff"><h3><font color="black">22.1 Overview</font>
</h3></td></tr></table>
</div><div class="section">
<a name="CSV-Overview" class="mark"></a>
The Bigloo csv library supports the parsing of csv and csv-like
data. By default, it enables the parsing of comma, tab, and pipe
separated data. In addition, facilities are provided that enable
extending the library to support additonal csv-like formats.<br/><br/>The rest of this document describes the Bigloo csv application programming
interface.<br/><br/></div><br>
<!-- API Reference -->
<a name="API-Reference"></a>
<div class="section-atitle"><table width="100%"><tr><td bgcolor="#dedeff"><h3><font color="black">22.2 API Reference</font>
</h3></td></tr></table>
</div><div class="section">
<a name="API-Reference" class="mark"></a>

<br/><br/><table cellspacing="0" class="frame" cellpadding="10" border="1" width="100%"><tbody>
<tr><td><a name="g25661" class="mark"></a><a name="read-csv-record" class="mark"></a><table width="100%" style="border-collapse: collapse;" frame="void" rules="none"><tbody>
<tr><td id="tc25665" align="left" colspan="1"><strong id='bold25663'
>read-csv-record</strong><em id='it25664'
> input-port [custom-lexer]</em></td><td id="tc25666" align="right" colspan="1">bigloo procedure</td></tr>
</tbody></table>

<code id='code25669'
>read-csv-record</code> has one required argument, the input-port of
the csv data to parse, and an optional argument indicating the lexer
to use, by default the lexer supporting standard csv files. It returns
a single record, as a list, or <code id='code25670'
>#eof-object</code>. Upon error, it will
throw an <code id='code25671'
>&amp;invalid-port-error</code> or <code id='code25672'
>&amp;io-parse-error</code>
exception.<br/><br/></td></tr>
</tbody></table><br/>

<table cellspacing="0" class="frame" cellpadding="10" border="1" width="100%"><tbody>
<tr><td><a name="g25677" class="mark"></a><a name="read-csv-records" class="mark"></a><table width="100%" style="border-collapse: collapse;" frame="void" rules="none"><tbody>
<tr><td id="tc25681" align="left" colspan="1"><strong id='bold25679'
>read-csv-records</strong><em id='it25680'
> input-port [custom-lexer]</em></td><td id="tc25682" align="right" colspan="1">bigloo procedure</td></tr>
</tbody></table>

<code id='code25685'
>read-csv-records</code> has one required argument, the input-port of
the csv data to parse, and an optional argument indicating the lexer
to use, by default the lexer supporting standard csv files. It returns
all of the records, as a list of lists, or <code id='code25686'
>#eof-object</code>. Upon
error, it will throw an <code id='code25687'
>&amp;invalid-port-error</code> or
<code id='code25688'
>&amp;io-parse-error exception</code>.<br/><br/></td></tr>
</tbody></table><br/><br/><br/>
<table cellspacing="0" class="frame" cellpadding="10" border="1" width="100%"><tbody>
<tr><td><a name="g25694" class="mark"></a><a name="csv-for-each" class="mark"></a><table width="100%" style="border-collapse: collapse;" frame="void" rules="none"><tbody>
<tr><td id="tc25698" align="left" colspan="1"><strong id='bold25696'
>csv-for-each</strong><em id='it25697'
> proc input-port [custom-lexer]</em></td><td id="tc25699" align="right" colspan="1">bigloo procedure</td></tr>
</tbody></table>

<code id='code25702'
>csv-for-each</code> has two required arguments, a procedure to apply
to each record and the input-port of the csv data to parse, and an
optional argument indicating the lexer to use, by default the lexer
supporting standard csv files. It returns <code id='code25703'
>#unspecified</code>. Upon
error, it will throw an <code id='code25704'
>&amp;invalid-port-error</code> or
<code id='code25705'
>&amp;io-parse-error exception</code>.<br/><br/></td></tr>
</tbody></table><br/>

<table cellspacing="0" class="frame" cellpadding="10" border="1" width="100%"><tbody>
<tr><td><a name="g25710" class="mark"></a><a name="csv-map" class="mark"></a><table width="100%" style="border-collapse: collapse;" frame="void" rules="none"><tbody>
<tr><td id="tc25714" align="left" colspan="1"><strong id='bold25712'
>csv-map</strong><em id='it25713'
> proc input-port [custom-lexer]</em></td><td id="tc25715" align="right" colspan="1">bigloo procedure</td></tr>
</tbody></table>

<code id='code25718'
>csv-map</code> has two required arguments, a procedure to apply to
each record and the input-port of the csv data to parse, and an
optional argument indicating the lexer to use, by default the lexer
supporting standard csv files. It returnsthe results of applying
<code id='code25719'
>proc</code> to each record as a list. Upon error, it will throw an
<code id='code25720'
>&amp;invalid-port-error</code> or <code id='code25721'
>&amp;io-parse-error</code> exception.<br/><br/></td></tr>
</tbody></table><br/><br/><br/>
<table cellspacing="0" class="frame" cellpadding="10" border="1" width="100%"><tbody>
<tr><td><a name="g25727" class="mark"></a><a name="make-csv-lexer" class="mark"></a><table width="100%" style="border-collapse: collapse;" frame="void" rules="none"><tbody>
<tr><td id="tc25731" align="left" colspan="1"><strong id='bold25729'
>make-csv-lexer</strong><em id='it25730'
> sep  quot</em></td><td id="tc25732" align="right" colspan="1">bigloo form</td></tr>
</tbody></table>

<code id='code25735'
>make-csv-lexer</code> has two required arguments, a character used to
separate records and a character for quoting. It returns custom lexer.
</td></tr>
</tbody></table><br/>

<table cellspacing="0" class="frame" cellpadding="10" border="1" width="100%"><tbody>
<tr><td><table width="100%" style="border-collapse: collapse;" frame="void" rules="none"><tbody>
<tr><td id="tc25739" align="center" colspan="1"><em id='it25738'
>bigloo variable +csv-lexer+</em></td><td id="tc25740" align="right" colspan="1">variable</td></tr>
</tbody></table>
<code id='code25744'
><em id='it25743'
>+csv-lexer+</em></code> is a bigloo-csv lexer supporting the standard comma-separated value format.
</td></tr>
</tbody></table><br/>

<table cellspacing="0" class="frame" cellpadding="10" border="1" width="100%"><tbody>
<tr><td><table width="100%" style="border-collapse: collapse;" frame="void" rules="none"><tbody>
<tr><td id="tc25748" align="center" colspan="1"><em id='it25747'
>bigloo variable +tsv-lexer+</em></td><td id="tc25749" align="right" colspan="1">variable</td></tr>
</tbody></table>
<code id='code25753'
><em id='it25752'
>+tsv-lexer+</em></code> is a bigloo-csv lexer supporting the tab-separated value format.
</td></tr>
</tbody></table><br/>

<table cellspacing="0" class="frame" cellpadding="10" border="1" width="100%"><tbody>
<tr><td><table width="100%" style="border-collapse: collapse;" frame="void" rules="none"><tbody>
<tr><td id="tc25757" align="center" colspan="1"><em id='it25756'
>bigloo variable +psv-lexer+</em></td><td id="tc25758" align="right" colspan="1">variable</td></tr>
</tbody></table>
<code id='code25762'
><em id='it25761'
>+psv-lexer+</em></code> is a bigloo-csv lexer supporting the pipe-separated value format.
</td></tr>
</tbody></table><br/>
The following is a simple example of using the bigloo-csv library. It parses a single record from the given csv data and prints it.<br/><br/><center id='center25779'
><table cellspacing="0" class="color" cellpadding="0" width="95%"><tbody>
<tr><td bgcolor="#ffffcc"><pre class="prog" id='prog25777'
>(<font color="#1919af"><strong id='bold34524'
>module</strong></font> <font color="#1919af"><strong id='bold34526'
>example</strong></font>
   (<font color="#1919af"><strong id='bold34528'
>library</strong></font> <font color="#1919af"><strong id='bold34530'
>bigloo-csv</strong></font>)
   (main main))<br/><br/>(<font color="#6959cf"><strong id='bold34532'
>define</strong></font> <font color="#6959cf"><strong id='bold34534'
>+csv-data+</strong></font> <font color="red">&quot;dog,cat,horse\npig,cow,squirrel&quot;</font>)<br/><br/>(<font color="#6959cf"><strong id='bold34537'
>define</strong></font> (<font color="#6959cf"><strong id='bold34539'
>main</strong></font> args)
   (<strong id='bold34541'
>let</strong> ((in (open-input-string +csv-data+)))
      (<font color="red"><strong id='bold34542'
>unwind-protect</strong></font>              
         (print (read-csv-record in))
         (close-input-port in)))) 
</pre>
</td></tr>
</tbody></table></center>
<br/><br/> 

</div><br>
</div></td>
</tr></table><div class="skribe-ending">
<hr> 
<p class="ending" id='paragraph34549'
><font size="-1">
This <span class="sc">Html</span> page has been produced by 
<a href="http://www-sop.inria.fr/indes/fp/Skribe" class="http">Skribe</a>.
<br/>
Last update <em id='it34547'
>Tue May  5 15:25:29 2015</em>.</font></p></div>
</body>
</html>