<!-- 95% W3C COMPLIANT, 95% CSS FREE, RAW HTML -->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1">
<title>Bigloo</title>
 <style type="text/css">
  <!--
  pre { font-family: monospace }
  tt { font-family: monospace }
  code { font-family: monospace }
  p.flushright { text-align: right }
  p.flushleft { text-align: left }
  span.sc { font-variant: small-caps }
  span.sf { font-family: sans-serif }
  span.skribetitle { font-family: sans-serif; font-weight: bolder; font-size: x-large; }
  span.refscreen { }
  span.refprint { display: none; }
  -->
 </style>
</head>

<body class="chapter" bgcolor="#ffffff">
<table width="100%" class="skribetitle" cellspacing="0" cellpadding="0"><tbody>
<tr><td align="center" bgcolor="#8381de"><div class="skribetitle"><strong><big><big><big>26. Bigloo<br/>A practical Scheme compiler<br/>User manual for version 4.2a<br/>April 2015 -- Explicit typing</big></big></big></strong></div><center>
</center>
</td></tr></tbody></table>
<table cellpadding="3" cellspacing="0" width="100%" class="skribe-margins"><tr>
<td align="left" valign="top" class="skribe-left-margin" width="20%" bgcolor="#dedeff"><div class="skribe-left-margin">
<br/><center id='center34769'
><table width="97%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse;" frame="box" rules="none"><tbody>
<tr bgcolor="#8381de"><th id="tc34759" align="center" colspan="1"><font color="#ffffff"><strong id='bold34757'
>main page</strong></font></th></tr>
<tr bgcolor="#ffffff"><td id="tc34766" align="center" colspan="1"><table width="100%" border="0" style="border-collapse: collapse;" frame="void" rules="none"><tbody>
<tr><td id="tc34762" align="left" valign="top" colspan="1"><strong id='bold34761'
>top:</strong></td><td id="tc34763" align="right" valign="top" colspan="1"><a href="bigloo.html#Bigloo-A-practical-Scheme-compiler-User-manual-for-version-4.2a-April-2015" class="inbound">Bigloo<br/>A practical Scheme compiler<br/>User manual for version 4.2a<br/>April 2015</a></td></tr>
</tbody></table>
</td></tr>
</tbody></table>
</center>
<br/><br/><center id='center34779'
><table width="97%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse;" frame="box" rules="none"><tbody>
<tr bgcolor="#8381de"><th id="tc34773" align="center" colspan="1"><font color="#ffffff"><strong id='bold34771'
>Explicit typing</strong></font></th></tr>
<tr bgcolor="#ffffff"><td id="tc34776" align="center" colspan="1"></td></tr>
</tbody></table>
</center>
<br/><br/><center id='center34789'
><table width="97%" border="1" cellpadding="0" cellspacing="0" style="border-collapse: collapse;" frame="box" rules="none"><tbody>
<tr bgcolor="#8381de"><th id="tc34783" align="center" colspan="1"><font color="#ffffff"><strong id='bold34781'
>Chapters</strong></font></th></tr>
<tr bgcolor="#ffffff"><td id="tc34786" align="center" colspan="1"><table cellspacing="1" cellpadding="1" width="100%" class="toc">
<tbody>
 <tr><td valign="top" align="left"></td><td colspan="4" width="100%"><a href="bigloo-1.html#Acknowledgements">Acknowledgements</a></td></tr>
 <tr><td valign="top" align="left">1</td><td colspan="4" width="100%"><a href="bigloo-2.html#Table-of-contents">Table of contents</a></td></tr>
 <tr><td valign="top" align="left">2</td><td colspan="4" width="100%"><a href="bigloo-3.html#Overview-of-Bigloo">Overview of Bigloo</a></td></tr>
 <tr><td valign="top" align="left">3</td><td colspan="4" width="100%"><a href="bigloo-4.html#Modules">Modules</a></td></tr>
 <tr><td valign="top" align="left">4</td><td colspan="4" width="100%"><a href="bigloo-5.html#Core-Language">Core Language</a></td></tr>
 <tr><td valign="top" align="left">5</td><td colspan="4" width="100%"><a href="bigloo-6.html#DSSSL-support">DSSSL support</a></td></tr>
 <tr><td valign="top" align="left">6</td><td colspan="4" width="100%"><a href="bigloo-7.html#Standard-Library">Standard Library</a></td></tr>
 <tr><td valign="top" align="left">7</td><td colspan="4" width="100%"><a href="bigloo-8.html#Pattern-Matching">Pattern Matching</a></td></tr>
 <tr><td valign="top" align="left">8</td><td colspan="4" width="100%"><a href="bigloo-9.html#Fast-search">Fast search</a></td></tr>
 <tr><td valign="top" align="left">9</td><td colspan="4" width="100%"><a href="bigloo-10.html#Structures-and-Records">Structures and Records</a></td></tr>
 <tr><td valign="top" align="left">10</td><td colspan="4" width="100%"><a href="bigloo-11.html#Object-System">Object System</a></td></tr>
 <tr><td valign="top" align="left">11</td><td colspan="4" width="100%"><a href="bigloo-12.html#Regular-parsing">Regular parsing</a></td></tr>
 <tr><td valign="top" align="left">12</td><td colspan="4" width="100%"><a href="bigloo-13.html#Lalr(1)-parsing">Lalr(1) parsing</a></td></tr>
 <tr><td valign="top" align="left">13</td><td colspan="4" width="100%"><a href="bigloo-14.html#Posix-Regular-Expressions">Posix Regular Expressions</a></td></tr>
 <tr><td valign="top" align="left">14</td><td colspan="4" width="100%"><a href="bigloo-15.html#Command-Line-Parsing">Command Line Parsing</a></td></tr>
 <tr><td valign="top" align="left">15</td><td colspan="4" width="100%"><a href="bigloo-16.html#Cryptography">Cryptography</a></td></tr>
 <tr><td valign="top" align="left">16</td><td colspan="4" width="100%"><a href="bigloo-17.html#Errors-Assertions-and-Traces">Errors, Assertions, and Traces</a></td></tr>
 <tr><td valign="top" align="left">17</td><td colspan="4" width="100%"><a href="bigloo-18.html#Threads">Threads</a></td></tr>
 <tr><td valign="top" align="left">18</td><td colspan="4" width="100%"><a href="bigloo-19.html#Database">Database</a></td></tr>
 <tr><td valign="top" align="left">19</td><td colspan="4" width="100%"><a href="bigloo-20.html#Multimedia">Multimedia</a></td></tr>
 <tr><td valign="top" align="left">20</td><td colspan="4" width="100%"><a href="bigloo-21.html#Mail">Mail</a></td></tr>
 <tr><td valign="top" align="left">21</td><td colspan="4" width="100%"><a href="bigloo-22.html#Text">Text</a></td></tr>
 <tr><td valign="top" align="left">22</td><td colspan="4" width="100%"><a href="bigloo-23.html#CSV">CSV</a></td></tr>
 <tr><td valign="top" align="left">23</td><td colspan="4" width="100%"><a href="bigloo-24.html#Eval-and-code-interpretation">Eval and code interpretation</a></td></tr>
 <tr><td valign="top" align="left">24</td><td colspan="4" width="100%"><a href="bigloo-25.html#Macro-expansion">Macro expansion</a></td></tr>
 <tr><td valign="top" align="left">25</td><td colspan="4" width="100%"><a href="bigloo-26.html#Parameters">Parameters</a></td></tr>
 <tr><td valign="top" align="left">26</td><td colspan="4" width="100%"><a href="bigloo-27.html#Explicit-typing">Explicit typing</a></td></tr>
 <tr><td valign="top" align="left">27</td><td colspan="4" width="100%"><a href="bigloo-28.html#The-C-interface">The C interface</a></td></tr>
 <tr><td valign="top" align="left">28</td><td colspan="4" width="100%"><a href="bigloo-29.html#The-Java-interface">The Java interface</a></td></tr>
 <tr><td valign="top" align="left">29</td><td colspan="4" width="100%"><a href="bigloo-30.html#Bigloo-Libraries">Bigloo Libraries</a></td></tr>
 <tr><td valign="top" align="left">30</td><td colspan="4" width="100%"><a href="bigloo-31.html#Extending-the-Runtime-System">Extending the Runtime System</a></td></tr>
 <tr><td valign="top" align="left">31</td><td colspan="4" width="100%"><a href="bigloo-32.html#SRFIs">SRFIs</a></td></tr>
 <tr><td valign="top" align="left">32</td><td colspan="4" width="100%"><a href="bigloo-33.html#Compiler-description">Compiler description</a></td></tr>
 <tr><td valign="top" align="left">33</td><td colspan="4" width="100%"><a href="bigloo-34.html#Cross-Compilation">Cross Compilation</a></td></tr>
 <tr><td valign="top" align="left">34</td><td colspan="4" width="100%"><a href="bigloo-35.html#User-Extensions">User Extensions</a></td></tr>
 <tr><td valign="top" align="left">35</td><td colspan="4" width="100%"><a href="bigloo-36.html#Bigloo-Development-Environment">Bigloo Development Environment</a></td></tr>
 <tr><td valign="top" align="left">36</td><td colspan="4" width="100%"><a href="bigloo-37.html#Global-Index">Global Index</a></td></tr>
 <tr><td valign="top" align="left">37</td><td colspan="4" width="100%"><a href="bigloo-38.html#Library-Index">Library Index</a></td></tr>
 <tr><td valign="top" align="left"></td><td colspan="4" width="100%"><a href="bigloo-39.html#Bibliography">Bibliography</a></td></tr>
</tbody>
</table>
</td></tr>
</tbody></table>
</center>
</div></td>
<td align="left" valign="top" class="skribe-body"><div class="skribe-body">
<a name="Explicit-Typing" class="mark"></a><a name="g26566" class="mark"></a>
Bigloo supports <em id='emph26568'
>type annotation</em> or <em id='emph26569'
>type information</em>. As shown in
Section ref Module declaration, these annotations can be written both in
the module clauses and in module bodies although module body type
information is optional. It helps the compiler to produce better quality
code and to reject incorrectly typed programs. Type annotations can describe
both the result and formal parameter types for global functions and also
types for local variable. Due to our module language design (in particular
module initialization), Scheme global variables <em id='emph26570'
>cannot</em> support type
information.<br/><br/>Types are either atomic types (see <a href="bigloo-28.html#Atomic-types" class="inbound">Atomic types</a>), foreign types
(see <a href="bigloo-28.html#Defining-an-extern-type" class="inbound">Defining an extern type</a>), or a classes
(see <a href="bigloo-11.html#Class-declaration" class="inbound">Class declaration</a>).<br/><br/><em id='emph26573'
>Warning: </em> All type annotations are ignored by the interpreter.<br/><br/>Module body type annotations are introduced by the following
special forms.<br/><br/><table cellspacing="0" class="frame" cellpadding="10" border="1" width="100%"><tbody>
<tr><td><table width="100%" style="border-collapse: collapse;" frame="void" rules="none"><tbody>
<tr><td id="tc26578" align="left" colspan="1"><strong id='bold26576'
>define</strong><em id='it26577'
> (f[::type] [a[::type]]...) body</em></td><td id="tc26579" align="right" colspan="1">bigloo syntax</td></tr>
</tbody></table>
<table width="100%" style="border-collapse: collapse;" frame="void" rules="none"><tbody>
<tr><td id="tc26584" align="left" colspan="1"><strong id='bold26582'
>define-inline</strong><em id='it26583'
> (f[::type] [a[::type]]...) body</em></td><td id="tc26585" align="right" colspan="1">bigloo syntax</td></tr>
</tbody></table>
<table width="100%" style="border-collapse: collapse;" frame="void" rules="none"><tbody>
<tr><td id="tc26590" align="left" colspan="1"><strong id='bold26588'
>let</strong><em id='it26589'
> ((var[::type] ...) ...) body</em></td><td id="tc26591" align="right" colspan="1">bigloo syntax</td></tr>
</tbody></table>
<table width="100%" style="border-collapse: collapse;" frame="void" rules="none"><tbody>
<tr><td id="tc26596" align="left" colspan="1"><strong id='bold26594'
>let</strong><em id='it26595'
> loop ((var[::type] ...) ...) body</em></td><td id="tc26597" align="right" colspan="1">bigloo syntax</td></tr>
</tbody></table>
<table width="100%" style="border-collapse: collapse;" frame="void" rules="none"><tbody>
<tr><td id="tc26602" align="left" colspan="1"><strong id='bold26600'
>let*</strong><em id='it26601'
> ((var[::type] ...) ...) body</em></td><td id="tc26603" align="right" colspan="1">bigloo syntax</td></tr>
</tbody></table>
<table width="100%" style="border-collapse: collapse;" frame="void" rules="none"><tbody>
<tr><td id="tc26608" align="left" colspan="1"><strong id='bold26606'
>letrec</strong><em id='it26607'
> ((var[::type] ...) ...) body</em></td><td id="tc26609" align="right" colspan="1">bigloo syntax</td></tr>
</tbody></table>
<table width="100%" style="border-collapse: collapse;" frame="void" rules="none"><tbody>
<tr><td id="tc26614" align="left" colspan="1"><strong id='bold26612'
>labels</strong><em id='it26613'
> ((var[::type] (var[::type]...) b) ...) body</em></td><td id="tc26615" align="right" colspan="1">bigloo syntax</td></tr>
</tbody></table>

Type annotations are optional. That is, for any of these
constructions, if a type annotation is missing, Bigloo uses
the default generic type <code id='code26618'
>obj</code> instead.<br/><br/>Here is an example of type annotated program:<br/><br/><center id='center26640'
><table cellspacing="0" class="color" cellpadding="0" width="95%"><tbody>
<tr><td bgcolor="#ffffcc"><pre class="prog" id='prog26638'
>(<font color="#1919af"><strong id='bold34790'
>module</strong></font> <font color="#1919af"><strong id='bold34792'
>example</strong></font>
   (<font color="#1919af"><strong id='bold34794'
>export</strong></font> (<font color="#1919af"><strong id='bold34796'
>vector-fill!</strong></font><font color="#00cf00"><strong id='bold34798'
>::vector</strong></font> <font color="#00cf00"><strong id='bold34800'
>::vector</strong></font> <font color="#00cf00"><strong id='bold34802'
>::obj</strong></font>)))<br/><br/>(<font color="#6959cf"><strong id='bold34804'
>define</strong></font> (<font color="#6959cf"><strong id='bold34806'
>vector-fill!</strong></font> v filler)
  (<strong id='bold34808'
>let</strong> loop ((i<font color="#00cf00"><strong id='bold34809'
>::long</strong></font> (- (vector-length v) 1)))
     (<strong id='bold34811'
>if</strong> (&lt; i 0)
         v
         (<strong id='bold34812'
>begin</strong>
            (vector-set! v i filler)
            (loop (- i 1))))))<br/><br/>(<strong id='bold34813'
>let</strong> ((v<font color="#00cf00"><strong id='bold34814'
>::vector</strong></font> (make-vector 3 4)))
   (vector-fill! v <font color="red">&quot;dummy&quot;</font>))
</pre>
</td></tr>
</tbody></table></center>

The types that can be used in annotations are any of: <br/><br/><ul class="itemize" id='itemize26654'
><li>the basic Scheme types <code id='code26642'
>pair</code>, <code id='code26643'
>null</code>, <code id='code26644'
>bstring</code>,
<code id='code26645'
>bint</code> (presented in Section <a href="bigloo-28.html#Defining-an-extern-type" class="inbound">Defining an extern type</a>).
</li>
<li>the basic extern types <code id='code26647'
>long</code>, <code id='code26648'
>int</code>, <code id='code26649'
>char</code>, 
<code id='code26650'
>string</code> presented in Section <a href="bigloo-28.html#Defining-an-extern-type" class="inbound">Defining an extern type</a>.
</li>
<li>the compound extern types described in Section 
<a href="bigloo-28.html#Defining-an-extern-type" class="inbound">Defining an extern type</a>.
</li>
<li>the types introduced by class declarations (Section 
<a href="bigloo-11.html#Class-declaration" class="inbound">Class declaration</a>).
</li>
</ul><br/><br/>When a function that contains type annotation is exported, the type 
annotations must be written in the prototype of the function in
the export clause. In that case the type annotation need to be
written in the function definition:<br/><br/><center id='center26667'
><table cellspacing="0" class="color" cellpadding="0" width="95%"><tbody>
<tr><td bgcolor="#ffffcc"><pre class="prog" id='prog26665'
>(<font color="#1919af"><strong id='bold34817'
>module</strong></font> <font color="#1919af"><strong id='bold34819'
>foo</strong></font>
   (<font color="#1919af"><strong id='bold34821'
>export</strong></font> (<font color="#1919af"><strong id='bold34823'
>succ</strong></font><font color="#00cf00"><strong id='bold34825'
>::int</strong></font> <font color="#00cf00"><strong id='bold34827'
>::int</strong></font>)))<br/><br/>(<font color="#6959cf"><strong id='bold34829'
>define</strong></font> (<font color="#6959cf"><strong id='bold34831'
>succ</strong></font> x) (+ 1 x))
</pre>
</td></tr>
</tbody></table></center>
</td></tr>
</tbody></table><br/>


</div></td>
</tr></table><div class="skribe-ending">
<hr> 
<p class="ending" id='paragraph34838'
><font size="-1">
This <span class="sc">Html</span> page has been produced by 
<a href="http://www-sop.inria.fr/indes/fp/Skribe" class="http">Skribe</a>.
<br/>
Last update <em id='it34836'
>Wed Apr  8 11:11:21 2015</em>.</font></p></div>
</body>
</html>
